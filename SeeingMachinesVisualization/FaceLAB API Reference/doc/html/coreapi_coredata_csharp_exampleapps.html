<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Seeing Machines CoreData API: CoreData C# Example Applications</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.0 -->
<h1><a class="anchor" name="coreapi_coredata_csharp_exampleapps">CoreData C# Example Applications</a></h1><ul>
<li><a class="el" href="coreapi_coredata_csharp_exampleapps.html#coreapi_coredata_csharp_exampleapps_log2net">log2net - Reads logfile data and send it over the network</a><br>
</li><li><a class="el" href="coreapi_coredata_csharp_exampleapps.html#coreapi_coredata_csharp_exampleapps_logconverter">logconverter - Reads and converts log file data</a><br>
</li><li><a class="el" href="coreapi_coredata_csharp_exampleapps.html#coreapi_coredata_csharp_exampleapps_netclient">netclient - Receives faceLAB/DSS UDP Packets</a><br>
</li></ul>
<p>
<hr>
 <h2><a class="anchor" name="coreapi_coredata_csharp_exampleapps_log2net">
log2net - Reads logfile data and send it over the network</a></h2>
The log2net console application reads data from binary faceLAB/DSS log file(s) and then sends it to a network host using UDP.<h3><a class="anchor" name="coreapi_coredata_csharp_exampleapps_log2net_usage">
Usage</a></h3>
To use the supplied version of log2net, run it with the arguments:<ol type=1>
<li><b>Dir</b>: Source of the logfile(s) to send. The tool will merge the .fll files within the folder into network packets and send them over the network. Note that the folder must contain exactly one set of faceLAB/DSS logfiles (i.e. one timing data file, etc).</li><li><b>Hostname or IP Address</b>: An optional argument for the host to send to. The default is localhost</li><li><b>Port number</b>: An optional argument for the UDP port to send to. The default is 2001, although it can be any port in the range 2000 - 5000</li></ol>
<p>
This application is good for testing code that reads from the network, without having to run faceLAB/DSS all the time, since you can run your client, then run log2net and see if the client is reading the data OK.<p>
<b>Example 1:</b><br>
 <div class="fragment"><pre class="fragment">
log2net c:/data/subject23 2044
</pre></div><p>
Merges the data from the logfiles in c:/data/subject23, and send the resulting packets to localhost, port 2044.<p>
<b>Example 2:</b><br>
 <div class="fragment"><pre class="fragment">
log2net c:/data/subject42 simulator.local
</pre></div><p>
Merges the data from the logfiles in c:/data/subject42, and send the resulting packets to simulator.local, port 2001.<h3><a class="anchor" name="coreapi_coredata_csharp_exampleapps_log2net_code">
Code</a></h3>
The example demonstrates using the EngineOutputDataFileReader to read multiple log files and serialize them into a buffer to send over a .Net DatagramSocket.<p>
 The sendData function creates a .Net DatagramSocket connected to a target address and calls sendEngineOutputDataFile with the filepath of the directory containg log files and the opened socket. <div class="fragment"><pre class="fragment">        <span class="keyword">static</span> <span class="keywordtype">void</span> sendData(string filepath, string host, <span class="keywordtype">int</span> udpPort)
        {
            InetAddress address = <span class="keyword">new</span> InetAddress(udpPort, host);
            <span class="keyword">using</span> (DatagramSocket socket = <span class="keyword">new</span> DatagramSocket())
            {
                socket.ConnectSocket(address);
                Console.WriteLine(<span class="stringliteral">"Connected to {0}, port {1}..."</span>, address.GetHostIP(), address.GetPort());
                Console.WriteLine(<span class="stringliteral">@"Sending {0}\*.fll"</span>, filepath);
                sendEngineOutputDataFile(filepath, socket);
            }
        } <span class="comment">// end of sendData</span>
</pre></div><p>
 The sendEngineOutputDataFile opens an EngineOutputDataFileReader with providing a set of object types of interest and the deserializes objects from the multiple log files, serializes them into a buffer and sends them over the DatagramSocket. <div class="fragment"><pre class="fragment">        <span class="keyword">static</span> <span class="keywordtype">void</span> sendEngineOutputDataFile(string dirpath, DatagramSocket socket)
        {
            VectorInt8 objectsToRead = <span class="keyword">new</span> VectorInt8();
            objectsToRead.Add((sbyte)TimingOutputData.THIS_OBJECT_ID);
            objectsToRead.Add((sbyte)HeadOutputData.THIS_OBJECT_ID);
            objectsToRead.Add((sbyte)EyeOutputData.THIS_OBJECT_ID);
            objectsToRead.Add((sbyte)WorldOutputData.THIS_OBJECT_ID);
            objectsToRead.Add((sbyte)FeatureSetsByCamera.THIS_OBJECT_ID);
            objectsToRead.Add((sbyte)CustomEventOutputData.THIS_OBJECT_ID);
            objectsToRead.Add((sbyte)GPSOutputDataV2.THIS_OBJECT_ID);

            <span class="keyword">using</span> (EngineOutputDataFileReader reader = <span class="keyword">new</span> EngineOutputDataFileReader())
            {
                reader.OpenFiles(objectsToRead, dirpath);
                VectorUInt8 buffer = <span class="keyword">new</span> VectorUInt8();
                <span class="keywordflow">while</span> (!reader.EndOfData())
                {
                    EngineOutputData data = reader.ReadData();
                    buffer.Clear();
                    data.Serialize(buffer);
                    socket.SendDatagram(buffer);
                    Console.Write(<span class="charliteral">'.'</span>);
                    Console.Out.Flush();
                    System.Threading.Thread.Sleep(15);
                }

            }
        } <span class="comment">// end of sendEngineOutputDataFile</span>
</pre></div><p>
<hr>
 <h2><a class="anchor" name="coreapi_coredata_csharp_exampleapps_logconverter">
logconverter -  Reads and converts log file data</a></h2>
The file logconverter.cpp converts binary logfile data into text format. The tool converts the specified logfile, or a list of the logfiles into a text version in the same folder. Text logfiles are column formatted, allowing them to be easily read into MATLAB or EXCEL.<h3><a class="anchor" name="coreapi_coredata_csharp_exampleapps_logconverter_usage">
Usage</a></h3>
To use the supplied version of logconverter, run it with the argument:<ol type=1>
<li><b>Filename(s)</b>: The logfile to convert, which must end in .fll</li></ol>
<p>
<b>Example 1:</b> <div class="fragment"><pre class="fragment">
logconverter test.fll
</pre></div> Converts test.fll to test.txt.<p>
<b>Example 2:</b> <div class="fragment"><pre class="fragment">
logconverter c:/faceLAB/logfiles/head.fll
</pre></div> Converts head.fll to text and saves in the c:/faceLAB/logfiles folder.<p>
Example 3: <div class="fragment"><pre class="fragment">
logconverter test.fll head.fll eyes.fll
</pre></div> Converts multiple files into the text format in one go.<h3><a class="anchor" name="coreapi_coredata_csharp_exampleapps_logconverter_mod">
Modifying</a></h3>
To minimize the changes you have to make when a new version of the API is released, we don’t recommend you change this application. It requires editing several of the core library files. If you do choose to modify this code (for example to only save a subset of the columns), try to make minimal changes and document these changes.<p>
<hr>
 <h2><a class="anchor" name="coreapi_coredata_csharp_exampleapps_netclient">
netclient - Receives faceLAB/DSS UDP Packets</a></h2>
The file netclient.cpp contains a simple function that listens to a specified port for faceLAB/DSS UDP packets, reading each packet into an EngineOutputData object.<p>
The program is designed to be a starting point for an application that needs to receive faceLAB/DSS data over a UDP network connection.<h3><a class="anchor" name="coreapi_coredata_csharp_exampleapps_netclient_usage">
Usage</a></h3>
To use the supplied version of netclient, run it with the optional argument:<ol type=1>
<li><b>Port</b>: The UDP port number to listen on. The default is 2001, and it must be between 2000 and 5000.</li></ol>
<p>
<b>Example 1:</b> <div class="fragment"><pre class="fragment">
netclient
</pre></div> Runs the netclient, listening on port 2001.<p>
<b>Example 2:</b> <div class="fragment"><pre class="fragment">
netclient 2010
</pre></div> Runs the netclient, listening on port 2010.<h3><a class="anchor" name="coreapi_coredata_csharp_exampleapps_netclient_mod">
Modifying</a></h3>
This project is designed for easy modification. The best place to modify the application is in the function <em>handleEngineOutputData</em>. In this function, the data has already been read from the network and placed in the EngineOutputData class structure. To use the structure, access the appropriate member of output_data. For example, to get the frame number use the notation: <em>output_data.frameNum()</em>. To get the head position, use <em><a class="el" href="namespacesm_1_1eod.html#992f781028939b8277987f29584bd01f">output_data.headOutputData()</a>-&gt;filteredHeadPosition()</em>.<p>
Refer to the EngineOutputData header file, or the HTML documentation for detailed information about the EngineOutputData contents. <hr size="1"><address style="align: right;"><small>Generated on Fri Apr 1 15:36:50 2011 for Seeing Machines CoreData API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.0 </small></address>
</body>
</html>
