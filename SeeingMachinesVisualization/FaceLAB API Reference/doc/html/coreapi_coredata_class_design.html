<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Seeing Machines CoreData API: CoreData Class Design</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.0 -->
<h1><a class="anchor" name="coreapi_coredata_class_design">CoreData Class Design</a></h1><h2><a class="anchor" name="coreapi_coredata_class_design_rules">
EngineOutputData Class Hierarchy Design Rules</a></h2>
<ul>
<li>No redundant fields between classes. That is, if class A derives from class B and we have a _foo_count member in class B, we cannot have a _foo_count member in class A. However we can have a foo-count in class AV2 which does not derive from class B (A version2), provided the old version of A is retired.</li></ul>
<p>
<ul>
<li>New versions of EOD classes must be constructible from previous versions. It is not necessary to construct old version from new versions.</li></ul>
<p>
<ul>
<li>Free functions are provided to access and lazily upgrade immediate sub-objects of an EngineOutputData object. These functions would have a signature like: <div class="fragment"><pre class="fragment">    <a class="code" href="namespacesm_1_1eod.html#0247eb708ecceb1d7a132395c85637e8">WorldOutputDataV2Ptr</a> <a class="code" href="namespacesm_1_1eod.html#ae4db148dcd70a2088d09424a569805e">worldOutputData</a>(<a class="code" href="namespacesm_1_1eod.html#2b72dec6fbc2ecde66ed7c5344e587ab">EngineOutputDataPtr</a>&amp;)
</pre></div> The implementation of the function is such that if the latest version is a sub-object, it is returned. Otherwise, if an older version is available then the latest version is constructed from the old version. The old version is removed from the EngineOutputData object and the new upgraded version added and returned. These functions should not have a version number embedded in them as each new version of the EOD should be source code compatible with the previous version. This reduces the amount of code that needs to be touched when a new version is released.</li></ul>
<p>
<ul>
<li>Old (retired) versions of classes are always removed from EngineOutputData interface. These are to be deprecated in favor of the free accessor functions described above. The current EngineOutputData member functions can only work for CoreData objects. This poses a problem for the DSS Data API in that it needs another method, ie. free functions mentioned above, to allow automatic upgrading of versioned objects.</li></ul>
<h2><a class="anchor" name="coreapi_coredata_class_design_fix">
Things To Add/Fix</a></h2>
<ul>
<li>Make tree flat - removing classes that act as nodes for multiple sub-objects, such as EyeOutputData. These just make it hard for people to find what they need. When we do this, retain support for old logfiles by ensuring the order of serialization of the flat tree is the same as the (old) deep tree.</li></ul>
<p>
<ul>
<li>Make new versions of the existing classes that are commonly used. These new classes should contain local (packed) structs that are serialized via reinterpret_cast, with an endian flag. No network by ordering occurs. Byte re-ordering only occurs when endianess is different when deserializing. Two goals here:<ol type=a>
<li>Speed up serialization / deserialization.</li><li>Start forming a C version of the SDK. These structs should exist in separate files that we will use to form a C SDK. The C++ classes then become convenience wrappers. If EngineOutputData is made into a flat tree, then we can represent it as C struct of structs, and we can write our serialization / deserialization routines also in C. C is important as it is the lowest-common-denominator language, enabling other higher-level language interfaces(Ruby, Perl, Java, C# and C++!)</li></ol>
</li></ul>
<p>
<ul>
<li>Add all the image-codes to ImagesOutputData. </li></ul>
<hr size="1"><address style="align: right;"><small>Generated on Fri Apr 1 15:36:50 2011 for Seeing Machines CoreData API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.0 </small></address>
</body>
</html>
